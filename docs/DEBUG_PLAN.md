# +TASTAS デバッグ計画書

## 概要
大勢でのシステムデバッグ実施計画

---

## デバッグチーム編成

| チーム | 担当領域 | 推奨人数 |
|--------|----------|----------|
| A | ワーカー側機能 | 3-4名 |
| B | 施設管理者側機能 | 2-3名 |
| C | システム管理者機能 | 1-2名 |
| D | クロスファンクション（連携テスト） | 2名 |

---

## デバッグ環境準備

### 事前準備（当日朝まで）
- [ ] 開発サーバー起動確認: `npm run dev`
- [ ] Docker PostgreSQL起動: `docker-compose up -d`
- [ ] テストデータ投入: `npx tsx prisma/seed.ts`
- [ ] 全員のアクセスURL共有: `http://[IPアドレス]:3000`

### テストアカウント
| 役割 | メールアドレス | パスワード |
|------|---------------|-----------|
| ワーカー1 | test1@example.com | password123 |
| ワーカー2 | test2@example.com | password123 |
| 施設管理者 | admin@facility.com | password123 |
| システム管理者 | admin@tastas.jp | （別途共有） |

---

## デバッグスケジュール

| 時間 | 内容 | 担当 |
|------|------|------|
| 09:00-09:30 | 環境確認・チーム分け | 全員 |
| 09:30-11:00 | 【フェーズ1】基本機能テスト | 各チーム |
| 11:00-11:15 | 休憩・中間報告 | 全員 |
| 11:15-12:30 | 【フェーズ2】連携テスト | 全員 |
| 12:30-13:30 | 昼休憩 | - |
| 13:30-15:00 | 【フェーズ3】エッジケース・負荷テスト | 各チーム |
| 15:00-15:30 | バグ報告まとめ・優先度付け | 全員 |
| 15:30-17:00 | 【フェーズ4】重要バグの即時修正 | 開発者 |

---

## フェーズ1: 基本機能テスト

### チームA: ワーカー側機能

#### 1. 認証・登録
- [ ] 新規登録フローが完了できる
- [ ] ログイン/ログアウトが正常動作
- [ ] パスワードリセットが機能する
- [ ] セッションが適切に維持される

#### 2. 求人検索・閲覧
- [ ] 求人一覧が表示される
- [ ] 検索フィルタ（地域、資格、日付）が機能する
- [ ] 求人詳細ページが正しく表示される
- [ ] 勤務日カレンダーが正しく表示される

#### 3. 応募機能
- [ ] 求人に応募できる
- [ ] 複数の勤務日を選択して応募できる
- [ ] 応募済みの求人に再応募できない
- [ ] 応募後に「応募済み」表示になる
- [ ] **エラー時にバナーが表示される**（新機能）

#### 4. マイページ
- [ ] プロフィール編集ができる
- [ ] プロフィール画像のアップロード/変更ができる
- [ ] 資格情報の登録ができる
- [ ] 応募履歴が表示される

#### 5. メッセージ
- [ ] メッセージ一覧が表示される
- [ ] 施設とのメッセージ送受信ができる
- [ ] 未読バッジが正しく表示される

#### 6. 勤務管理
- [ ] 予定している勤務が表示される
- [ ] 勤務完了後にレビュー投稿ができる

---

### チームB: 施設管理者側機能

#### 1. 認証
- [ ] 施設管理者ログインができる
- [ ] ログアウトが正常動作

#### 2. 求人管理
- [ ] 新規求人を作成できる
- [ ] 求人を編集できる
- [ ] 求人を公開/停止できる
- [ ] 勤務日を追加/削除できる
- [ ] 求人テンプレートを使用できる

#### 3. 応募管理
- [ ] 応募一覧が表示される
- [ ] 応募を承認（マッチング）できる
- [ ] 応募を却下できる
- [ ] 月間シフトビューが正しく表示される
- [ ] **未確認応募バッジが勤務日ごとに表示される**（修正済み）

#### 4. ワーカー管理
- [ ] マッチしたワーカー一覧が表示される
- [ ] ワーカー詳細が確認できる
- [ ] ワーカーをお気に入り/ブロックできる
- [ ] ワーカーにレビューを投稿できる

#### 5. メッセージ
- [ ] ワーカー別のメッセージ一覧が表示される
- [ ] ワーカーにメッセージを送信できる
- [ ] 未読件数が正しく表示される

#### 6. 施設設定
- [ ] 施設情報を編集できる
- [ ] アカウント管理ができる

---

### チームC: システム管理者機能

#### 1. ダッシュボード
- [ ] 統計情報が表示される
- [ ] アラートが表示される

#### 2. 施設管理
- [ ] 施設一覧が表示される
- [ ] 施設の承認/却下ができる
- [ ] 施設詳細が確認できる

#### 3. ワーカー管理
- [ ] ワーカー一覧が表示される
- [ ] ワーカー詳細が確認できる

#### 4. コンテンツ管理
- [ ] 通知テンプレートを編集できる
- [ ] **エラーメッセージ設定が動作する**（新機能）
  - [ ] 一覧でON/OFFトグルが動作する
  - [ ] 編集モーダルでメッセージを変更できる
  - [ ] バナー用/詳細用の2種類のメッセージが保存される
- [ ] FAQを編集できる
- [ ] 利用規約を編集できる

#### 5. アナリティクス
- [ ] 各種グラフが表示される
- [ ] 期間フィルタが機能する

---

## フェーズ2: 連携テスト（クロスファンクション）

### シナリオ1: 応募〜マッチング〜勤務完了フロー
```
1. [ワーカー] 求人を検索して応募
2. [施設管理者] 応募を確認してマッチング承認
3. [ワーカー] マッチング通知を確認
4. [施設管理者] ワーカーにメッセージ送信
5. [ワーカー] メッセージを確認して返信
6. [施設管理者] 勤務完了処理
7. [ワーカー] 施設にレビュー投稿
8. [施設管理者] ワーカーにレビュー投稿
```

### シナリオ2: キャンセルフロー
```
1. [ワーカー] 求人に応募
2. [施設管理者] マッチング承認
3. [ワーカー] マッチング後にキャンセル
4. [施設管理者] キャンセル通知を確認
5. [システム] キャンセル率が更新される
```

### シナリオ3: 複数ワーカー同時応募
```
1. [ワーカーA, B, C] 同じ求人に同時応募
2. [施設管理者] 募集人数分だけマッチング
3. [システム] 募集枠が正しく更新される
4. [ワーカー] 枠が埋まった求人に応募できない
```

### シナリオ4: エラーハンドリング
```
1. [ワーカー] ネットワークエラー状態で応募
2. [システム] エラーバナーが表示される
3. [システム管理者] エラーメッセージ設定でバナーをOFF
4. [ワーカー] 同じエラーでバナーが表示されない
```

---

## フェーズ3: エッジケース・負荷テスト

### エッジケース

#### 入力値テスト
- [ ] 空文字での送信
- [ ] 最大文字数での入力
- [ ] 特殊文字（絵文字、HTML、SQLインジェクション風）
- [ ] 日本語・英語混在

#### 日時関連
- [ ] 過去の日付での求人作成
- [ ] 深夜0時をまたぐ勤務時間
- [ ] タイムゾーン境界（日本時間）

#### 権限関連
- [ ] ログアウト状態でのアクセス
- [ ] 他人のデータへのアクセス試行
- [ ] URLの直接入力でのアクセス

### 負荷テスト（複数人で同時操作）
- [ ] 同時ログイン（10人以上）
- [ ] 同時検索（10人以上）
- [ ] 同一求人への同時応募（5人以上）
- [ ] 同時メッセージ送信

---

## バグ報告フォーマット

### 報告テンプレート

```
【バグID】BUG-YYYYMMDD-001
【報告者】
【発見日時】
【重要度】Critical / High / Medium / Low
【カテゴリ】認証 / 求人 / 応募 / メッセージ / UI / その他
【再現手順】
1.
2.
3.
【期待される動作】
【実際の動作】
【スクリーンショット】
【ブラウザ/OS】
【備考】
```

### 重要度の定義

| 重要度 | 定義 | 例 |
|--------|------|-----|
| Critical | サービス停止レベル | ログインできない、データ消失 |
| High | 主要機能が使えない | 応募できない、マッチングできない |
| Medium | 機能は使えるが問題あり | 表示崩れ、エラーメッセージ不適切 |
| Low | 軽微な問題 | 誤字、色の違和感 |

---

## チェックリスト一覧（印刷用）

### ワーカー機能チェックリスト

```
□ 新規登録完了
□ ログイン成功
□ 求人一覧表示
□ 検索フィルタ動作
□ 求人詳細表示
□ 応募完了
□ 応募エラー時バナー表示
□ マイページ表示
□ プロフィール編集保存
□ 画像アップロード
□ メッセージ一覧表示
□ メッセージ送信
□ 勤務予定表示
□ レビュー投稿

テスト者: ____________
日時: ____________
```

### 施設管理者機能チェックリスト

```
□ ログイン成功
□ 求人作成
□ 求人編集
□ 求人公開/停止
□ 応募一覧表示
□ マッチング承認
□ 月間シフト表示
□ 未確認バッジ表示
□ ワーカー一覧表示
□ ワーカー詳細表示
□ メッセージ送信
□ レビュー投稿
□ 施設情報編集

テスト者: ____________
日時: ____________
```

### システム管理者機能チェックリスト

```
□ ログイン成功
□ ダッシュボード表示
□ 施設一覧表示
□ 施設承認
□ ワーカー一覧表示
□ 通知テンプレート編集
□ エラーメッセージ設定
  □ 一覧表示
  □ トグルON/OFF
  □ メッセージ編集
□ FAQ編集
□ アナリティクス表示

テスト者: ____________
日時: ____________
```

### 連携テストチェックリスト

```
□ シナリオ1: 応募〜完了フロー
□ シナリオ2: キャンセルフロー
□ シナリオ3: 複数同時応募
□ シナリオ4: エラーハンドリング

テスト者: ____________
日時: ____________
```

---

## 既知の問題・注意点

1. **CSSキャッシュ問題**: スタイルが効かない場合は `Cmd+Shift+R` でハードリロード
2. **開発サーバー**: 長時間稼働で不安定になる場合は `rm -rf .next && npm run dev` で再起動
3. **セッション**: 8時間でタイムアウト

---

## 連絡先

- バグ報告: Slackの #debug チャンネル
- 緊急連絡: [担当者名]
