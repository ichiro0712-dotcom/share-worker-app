# +TASTAS - 画面仕様書（実装ベース）

> **最終更新**: 2025-12-15
> **ステータス**: 実稼働システムからの逆引き定義

---

## 1. 画面構成概要

### 1.1 ワーカー向け画面（17画面）
```
/                           → 求人一覧（トップ）
/jobs/[id]                  → 求人詳細
/login                      → ログイン
/register                   → 会員登録（工事中）
/application-confirm        → 応募確認
/application-complete       → 応募完了
/my-jobs                    → 仕事管理（応募・勤務状況）
/mypage                     → マイページトップ
/mypage/profile             → プロフィール編集
/mypage/applications        → 応募履歴
/mypage/reviews             → レビュー管理
/mypage/reviews/received    → 受け取ったレビュー
/mypage/muted-facilities    → ミュート施設
/messages                   → メッセージ
/notifications              → 通知
/bookmarks                  → ブックマーク
/favorites                  → お気に入り
/facilities/[id]            → 施設詳細
```

### 1.2 施設管理者向け画面（17画面）
```
/admin                          → 求人一覧へリダイレクト
/admin/login                    → ログイン
/admin/jobs                     → 求人一覧
/admin/jobs/new                 → 求人作成
/admin/jobs/[id]                → 求人詳細
/admin/jobs/[id]/edit           → 求人編集
/admin/jobs/templates           → テンプレート一覧
/admin/jobs/templates/new       → テンプレート作成
/admin/jobs/templates/[id]/edit → テンプレート編集
/admin/applications             → 応募者管理
/admin/workers                  → ワーカー一覧
/admin/workers/[id]             → ワーカー詳細
/admin/workers/[id]/review      → ワーカー評価
/admin/messages                 → メッセージ
/admin/reviews                  → レビュー一覧
/admin/worker-reviews           → ワーカーレビュー
/admin/facility                 → 施設情報
/admin/notifications            → 通知
```

---

## 2. ワーカー向け画面詳細

### 2.1 求人一覧（トップページ）
**パス**: `/`

**レイアウト**:
- ヘッダー: 検索バー、フィルターボタン
- メイン: 求人カードのグリッド表示
- フッター: ナビゲーションバー（5タブ）

**機能**:
- キーワード検索（求人タイトル、施設名）
- フィルター
  - 都道府県/市区町村
  - 時給（最小値指定）
  - サービスタイプ
  - 移動手段
  - こだわり条件
- 並べ替え（時給順、締切順、新着順）
- 無限スクロール
- URL保持（検索条件）

**求人カード表示項目**:
- 施設画像
- 施設名・評価
- 求人タイトル
- 勤務日時
- 報酬（日給/時給）
- 締切表示
- タグ（施設種別、特徴）
- ブックマークボタン

---

### 2.2 求人詳細
**パス**: `/jobs/[id]`

**レイアウト**:
- ヘッダー: 戻るボタン、タイトル
- メイン: タブ切り替え型コンテンツ
- フッター: 応募ボタン（固定）

**タブ構成**:
1. **概要**: 基本情報、勤務条件
2. **詳細**: 業務内容、必要資格
3. **条件**: 服装、持ち物、移動手段
4. **レビュー**: 施設評価、コメント

**表示項目**:
- 施設画像（カルーセル）
- 施設名、住所、アクセス
- 勤務日時
- 報酬（日給、時給、交通費）
- 応募状況（募集人数/応募人数）
- 締切時間（カウントダウン）
- 業務内容
- 必要資格・経験
- 服装・持ち物
- 移動手段・駐車場
- 責任者情報
- 他日程の求人（横スクロール）

**インタラクション**:
- お気に入り登録
- ブックマーク保存
- ミュート機能
- 応募ボタン → 応募確認モーダルを表示

**応募確認モーダル**:
- 求人タイプに応じたメッセージ:
  - 審査あり求人: 「この求人に応募しますか？」「施設での審査後、結果をお知らせします。」
  - 通常求人: 「この求人に応募しますか？」「応募後、すぐにマッチング結果が確定します。」
- 選択した勤務日一覧表示
- 自己PR表示・編集機能:
  - 自己PR未設定時: 警告表示「自己PRが設定されていません。施設への印象を高めるため、設定することをお勧めします。」
  - モーダル内での自己PR編集・保存機能
- ボタン: 「戻る」「応募する」

---

### 2.3 ログイン
**パス**: `/login`

**フォーム項目**:
- メールアドレス
- パスワード
- ログインボタン
- 新規登録リンク
- パスワード忘れリンク

---

### 2.4 応募確認
**パス**: `/application-confirm`

**表示項目**:
- 求人情報サマリー
- ワーカープロフィール
- 資格情報
- 応募ボタン
- キャンセルボタン

---

### 2.5 応募完了
**パス**: `/application-complete`

**表示項目**:
- 完了メッセージ
- 求人情報サマリー
- 次のステップ案内
- トップへ戻るボタン

---

### 2.6 仕事管理
**パス**: `/my-jobs`

**レイアウト**:
- ヘッダー: ページタイトル「お仕事」
- メイン: タブ切り替え + 応募カード一覧
- フッター: ナビゲーションバー

**タブ構成**:
| タブ名 | ステータス | 説明 |
|--------|-----------|------|
| 審査中 | APPLIED | 応募済み・施設審査待ち |
| 仕事の予定 | SCHEDULED | マッチング成立・勤務予定 |
| 勤務中 | WORKING | 現在勤務中 |
| 完了 | COMPLETED_RATED | 勤務完了・評価済み |
| キャンセル | CANCELLED | キャンセル済み |

**カード表示項目**:
- 施設名
- 求人タイトル
- 勤務日時
- 時給・日給
- ステータスバッジ
- アクションボタン

**審査中タブの機能**:
- 応募取消ボタン表示
- 取消確認モーダル
  - メッセージ: 「この応募を取り消しますか？」
  - 注意書き: 「※審査中の取り消しはキャンセル率に影響しません」
  - ボタン: 「戻る」「取り消す」
- 審査中の取り消しはキャンセル率に影響しない（`cancelled_by = null`で記録）
- 成功時トースト: 「応募を取り消しました（キャンセル率には影響しません）」

**仕事の予定タブの機能**:
- キャンセルボタン表示（勤務前日まで）
- キャンセル確認モーダル:
  - ヘッダー: 「キャンセルの確認」
  - 求人情報表示（求人タイトル、施設名、勤務日時）
  - 警告メッセージ: 「この予約をキャンセルすると、あなたのキャンセル率に影響し、施設から確認できるようになります。」
  - ボタン: 「戻る」「キャンセルする」
- キャンセル時は `cancelled_by = 'WORKER'` で記録（キャンセル率に影響）

**勤務中タブの機能**:
- キャンセルボタン表示
- キャンセル確認モーダル（仕事の予定タブと同様）
- キャンセル時は `cancelled_by = 'WORKER'` で記録（キャンセル率に影響）

---

### 2.7 マイページ
**パス**: `/mypage`

**メニュー項目**:
- プロフィール編集
- 応募履歴
- レビュー管理
- 受け取ったレビュー
- お気に入り
- ブックマーク
- ミュート施設
- 通知設定
- ログアウト

---

### 2.8 プロフィール編集
**パス**: `/mypage/profile`

**セクション構成**:
1. **基本情報**: 氏名、カナ、性別、国籍、生年月日、電話番号、画像
2. **住所**: 郵便番号、都道府県、市区町村、番地、建物名
3. **緊急連絡先**: 氏名、続柄、電話番号、住所
4. **資格・経験**: 保有資格、経験分野、職歴
5. **希望条件**: 働き方、日数、曜日、時間
6. **その他**: 自己PR、銀行口座、年金番号

---

### 2.9 応募履歴
**パス**: `/mypage/applications`

**表示項目**:
- ステータスフィルター
- 応募一覧（カード形式）
  - 求人情報
  - 応募日時
  - ステータス
  - アクションボタン

---

### 2.10 メッセージ
**パス**: `/messages`

**レイアウト**:
- 会話一覧（左パネル/上部）
- メッセージスレッド（右パネル/下部）

**機能**:
- 施設ごとの会話一覧表示（応募単位ではなく施設単位）
- LINE風のチャットUI
- 未読バッジ
- メッセージ送受信
- 既読表示
- ファイル添付機能

**添付ファイル機能**:
- 対応ファイル形式:
  - 画像: jpg, jpeg, png, gif, webp, heic, heif, bmp, tiff, svg
  - 文書: pdf, doc, docx, xls, xlsx, txt, csv
- 最大ファイルサイズ: 15MB/ファイル
- 最大添付数: 3ファイル/メッセージ
- 画像プレビュー: タップで拡大表示（ライトボックス）
- 文書ファイル: タップで別タブ表示

---

### 2.11 通知
**パス**: `/notifications`

**表示項目**:
- 通知一覧
  - タイプアイコン
  - タイトル
  - 内容
  - 日時
  - 既読/未読

---

### 2.12 ブックマーク・お気に入り
**パス**: `/bookmarks`, `/favorites`

**表示項目**:
- 求人/施設一覧
- 削除ボタン
- 詳細へのリンク

---

## 3. 施設管理者向け画面詳細

### 3.1 求人一覧
**パス**: `/admin/jobs`

**機能**:
- ステータスフィルター
- 検索
- 新規作成ボタン
- 求人カード一覧

**表示項目/カード**:
- 求人タイトル
- 勤務日
- 応募状況
- ステータス
- 編集/削除ボタン

---

### 3.3 求人作成・編集
**パス**: `/admin/jobs/new`, `/admin/jobs/[id]/edit`

**フォームセクション**:
1. **テンプレート選択**: 既存テンプレートから選択（任意）
2. **基本情報**: タイトル、勤務時間
3. **勤務日設定**: カレンダーで複数日選択、日別募集人数
4. **報酬**: 時給、日給自動計算、交通費
   - 日給計算は深夜手当（22:00〜05:00: 1.25倍）、残業手当（8時間超: 1.25倍）を含む
   - 詳細な計算ロジックは [QR勤怠機能仕様書 セクション9](../features/qr-attendance.md#9-給与計算ロジック) を参照
   - **交通費**: 0円〜1,000円（25円単位で選択）、上限1,000円
     - 最低額は実働時間に応じて動的に計算（15分あたり25円 = 1時間あたり100円）
     - 長時間勤務でも上限は1,000円
     - ヘルパーテキスト表示:
       - 10時間未満: 「※ 実働○時間の場合、最低○○円以上」
       - 10時間以上: 「※ 実働○時間の場合、交通費は上限の1,000円となります」
5. **締切設定**: 勤務日の何日前
6. **業務内容**: チェックボックス選択、詳細テキスト
7. **資格・経験**: 必要資格、経験
8. **服装・持ち物**: リスト入力
9. **移動手段**: チェックボックス（車、バイク、自転車、公共交通、駐車場）
10. **こだわり条件**: チェックボックス（入浴介助なし、未経験歓迎など）
11. **募集条件**: 週N回以上、1ヶ月以上など
12. **マッチング方式**: ☑️ 審査してからマッチング（有効時は応募後に手動でマッチング決定）
13. **責任者情報**: 名前、メッセージ、アバター
14. **画像**: アップロード（複数可）

---

### 3.4 テンプレート管理
**パス**: `/admin/jobs/templates`, `/admin/jobs/templates/new`, `/admin/jobs/templates/[id]/edit`

**機能**:
- テンプレート一覧
- 新規作成
- 編集/削除
- 求人作成時の適用

**テンプレート項目**:
- テンプレート名
- 求人タイトル
- 勤務時間
- 時給
- 交通費
- 募集人数
- 資格要件
- 業務内容
- 服装・持ち物

---

### 3.5 応募者管理
**パス**: `/admin/applications`

**タブ切り替え**:
- [求人から]: 求人ごとの応募者一覧（従来の画面）
- [ワーカーから]: ワーカーごとの応募履歴一覧（新規）

**「求人から」ビュー**:

*フィルター*:
- 求人選択
- ステータスフィルター
- 日付範囲

*一覧表示*:
- ワーカー名
- 求人タイトル
- 勤務日
- 応募日時
- ステータス（キャンセル時の区別表示あり）
- アクションボタン（審査あり求人: マッチング決定/不採用、通常求人: キャンセルのみ）

*キャンセルステータスの表示区別*:
- **ワーカー辞退**（赤色）: `cancelled_by = 'WORKER'`（マッチング後のワーカー起因キャンセル、キャンセル率に影響）
- **施設キャンセル**（グレー）: `cancelled_by = 'FACILITY'`（施設起因のキャンセル）
- **応募取消**（黄色）: `cancelled_by = null`（審査中の応募取消、キャンセル率に影響なし）

**「ワーカーから」ビュー**:

*ワーカーカード形式*:
- 顔写真
- 氏名
- 年齢
- 性別
- 資格
- 経験
- お気に入り/ブロックボタン
- カードクリックでワーカー詳細（`/admin/workers/[id]`）へ遷移

**ワーカー詳細表示**:
- プロフィール
- 資格
- 過去の勤務履歴
- 評価
- キャンセル率

---

### 3.6 ワーカー一覧
**パス**: `/admin/workers`

**フィルター**:
- 職種
- ステータス
- 名前検索

**一覧表示**:
- 名前
- 資格
- 勤務回数
- 平均評価
- 最終勤務日
- お気に入りボタン

---

### 3.7 ワーカー詳細
**パス**: `/admin/workers/[id]`

**表示項目**:
- プロフィール情報
- 資格・経験
- 勤務履歴
- 評価一覧
- キャンセル率
- お気に入り/ブロック操作

---

### 3.8 ワーカー評価
**パス**: `/admin/workers/[id]/review`

**評価フォーム**:
- 総合評価（5段階）
- 詳細評価
  - 勤怠・時間
  - スキル
  - 遂行力
  - コミュニケーション力
  - 姿勢
- 良かった点（テキスト）
- 改善点（テキスト）
- テンプレート選択

---

### 3.9 メッセージ
**パス**: `/admin/messages`

**機能**:
- ワーカー別会話一覧（複数の応募をワーカーごとに統合）
- メッセージ送受信
- 未読管理
- ファイル添付機能

**添付ファイル機能**:
- 対応ファイル形式:
  - 画像: jpg, jpeg, png, gif, webp, heic, heif, bmp, tiff, svg
  - 文書: pdf, doc, docx, xls, xlsx, txt, csv
- 最大ファイルサイズ: 15MB/ファイル
- 最大添付数: 3ファイル/メッセージ
- 画像プレビュー: クリックで拡大表示（ライトボックス）
- 文書ファイル: クリックで別タブ表示

---

### 3.10 施設情報
**パス**: `/admin/facility`

**編集項目**:
- 法人名
- 施設名
- 施設種別
- 住所
- 電話番号
- 説明文
- 画像
- 初回メッセージ（自動送信）

**地図関連**:
- 地図画像の表示（住所変更時に自動更新）
- 「地図画像を更新」ボタン（手動更新）
- ※ マップピン位置の微調整が必要な場合は、運営サポートへ問い合わせ
- ※ マップピン調整機能はシステム管理者画面で提供（詳細: system-admin-features.md）

---

## 4. 共通コンポーネント

### 4.1 ナビゲーション

**ワーカー用フッターナビ**:
| アイコン | ラベル | パス |
|----------|--------|------|
| Search | 探す | `/` |
| Bookmark | お気に入り | `/favorites` |
| MessageSquare | メッセージ | `/messages` |
| Briefcase | 仕事 | `/mypage/applications` |
| User | マイページ | `/mypage` |

**施設管理者用サイドバー**:
| アイコン | ラベル | パス |
|----------|--------|------|
| Briefcase | 求人管理 | `/admin/jobs` |
| FileText | テンプレート | `/admin/jobs/templates` |
| UserCheck | 応募管理 | `/admin/applications` |
| Users | ワーカー管理 | `/admin/workers` |
| Star | ワーカーレビュー | `/admin/worker-reviews` |
| MessageCircle | メッセージ | `/admin/messages` |
| Building2 | 法人・施設 | `/admin/facility` |
| Star | 施設レビュー | `/admin/reviews` |

### 4.2 共通UI要素

**ボタン**:
- Primary: 緑系（#66cc99）
- Secondary: グレー系
- Danger: 赤系

**カード**:
- 白背景
- 角丸
- 影付き

**フォーム**:
- ラベル: 上配置
- 入力欄: フル幅
- バリデーション: リアルタイム

**モーダル**:
- 中央配置
- オーバーレイ背景
- 閉じるボタン

---

## 5. レスポンシブ対応

### ブレークポイント
- **モバイル**: 〜767px
- **タブレット**: 768px〜1023px
- **デスクトップ**: 1024px〜

### モバイル対応
- ワーカー向け画面はモバイルファースト
- フッターナビゲーション固定
- カード1列表示

### デスクトップ対応
- 施設管理者画面はデスクトップ最適化
- サイドバーナビゲーション
- カード複数列表示

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-15 | 求人詳細画面に応募確認モーダル追加（審査あり/なし対応、自己PR編集機能） |
| 2025-12-15 | 仕事管理画面のキャンセル確認モーダル仕様拡充（SCHEDULED/WORKINGタブ） |
| 2025-12-15 | 施設側応募管理画面でcancelled_by区別表示追加、審査中→応募取消への用語変更 |
| 2025-12-15 | /my-jobs（仕事管理）画面を追加、審査中タブとキャンセル機能を仕様化 |
| 2025-12-04 | 実稼働システムから画面仕様書を再作成 |
