# LP ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ  è¨­è¨ˆä»•æ§˜æ›¸

## 1. æ¦‚è¦

+TASTASã®LPï¼ˆãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ï¼‰ã®åŠ¹æœæ¸¬å®šã‚’è¡Œã†ãŸã‚ã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã€‚
åºƒå‘Šã‹ã‚‰ã®æµå…¥ã‚’è¿½è·¡ã—ã€ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæŒ‡æ¨™ã‚’è¨ˆæ¸¬ã—ã€ãƒ¯ãƒ¼ã‚«ãƒ¼ç™»éŒ²ã¾ã§ã®ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ†æã™ã‚‹ã€‚

### 1.1 ç›®çš„
- LPçµŒç”±ã®æµå…¥å…ƒï¼ˆåºƒå‘Šã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ï¼‰ã‚’ç‰¹å®š
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆåº¦ã‚’è¨ˆæ¸¬
- CTAã‚¯ãƒªãƒƒã‚¯ï¼ˆLINEç™»éŒ²ï¼‰ã®åŠ¹æœã‚’æ¸¬å®š
- ãƒ¯ãƒ¼ã‚«ãƒ¼ç™»éŒ²ã¾ã§ã®ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¿½è·¡
- åºƒå‘ŠæŠ•è³‡å¯¾åŠ¹æœï¼ˆROIï¼‰ã®åˆ†æ

### 1.2 å¯¾è±¡ãƒšãƒ¼ã‚¸
- `/lp/0`, `/lp/1`, `/lp/2`... - ç®¡ç†ç”»é¢ã‹ã‚‰è¿½åŠ ã•ã‚Œã‚‹LPãƒšãƒ¼ã‚¸

---

## 2. LPç®¡ç†æ©Ÿèƒ½

### 2.1 æ¦‚è¦

LPï¼ˆãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ï¼‰ã®è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ã‚’ç®¡ç†ç”»é¢ã‹ã‚‰è¡Œã†æ©Ÿèƒ½ã€‚
ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸHTMLã«ã¯ã€ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã«å¿…è¦ãªã‚¿ã‚°ãŒè‡ªå‹•æŒ¿å…¥ã•ã‚Œã‚‹ã€‚

### 2.2 ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ–¹å¼

| é …ç›® | ä»•æ§˜ |
|------|------|
| ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ | ZIPãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆHTML + ç”»åƒã‚’ã¾ã¨ã‚ã¦ï¼‰ |
| ä¿å­˜å…ˆ | Supabase Storageï¼ˆ`lp-assets` ãƒã‚±ãƒƒãƒˆï¼‰ |
| é…ä¿¡æ–¹å¼ | `/api/lp/[id]` APIãƒ«ãƒ¼ãƒˆã§é…ä¿¡ï¼ˆèªè¨¼ä¸è¦ãƒ»å…¬é–‹ã‚¢ã‚¯ã‚»ã‚¹å¯ï¼‰ |
| LPç•ªå· | è‡ªå‹•é€£ç•ªï¼ˆ0, 1, 2...ï¼‰ã€æ¬ ç•ªã¯å†åˆ©ç”¨ã—ãªã„ |

### 2.3 ZIPæ§‹æˆä¾‹

```
my-lp.zip
â”œâ”€â”€ index.html      # å¿…é ˆ: ãƒ¡ã‚¤ãƒ³HTML
â”œâ”€â”€ styles.css      # ä»»æ„: ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ
â””â”€â”€ images/         # ä»»æ„: ç”»åƒãƒ•ã‚©ãƒ«ãƒ€
    â”œâ”€â”€ hero.png
    â””â”€â”€ logo.svg
```

### 2.4 è‡ªå‹•æŒ¿å…¥ã‚¿ã‚°

ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚ã€ä»¥ä¸‹ã®ã‚¿ã‚°ãŒHTMLã«è‡ªå‹•æŒ¿å…¥ã•ã‚Œã‚‹ï¼ˆé‡è¤‡ãƒã‚§ãƒƒã‚¯ä»˜ãï¼‰ï¼š

| ã‚¿ã‚° | æŒ¿å…¥ä½ç½® | é‡è¤‡æ™‚ã®å‹•ä½œ |
|------|----------|--------------|
| GTMã‚¿ã‚°ï¼ˆ`<script>`ï¼‰ | `<head>` å†… | æ—¢å­˜ãŒã‚ã‚Œã°æŒ¿å…¥ã—ãªã„ |
| GTMã‚¿ã‚°ï¼ˆ`<noscript>`ï¼‰ | `<body>` ç›´å¾Œ | æ—¢å­˜ãŒã‚ã‚Œã°æŒ¿å…¥ã—ãªã„ |
| LINEå‹ã ã¡ç™»éŒ²ãƒœã‚¿ãƒ³å±æ€§ | LINE CTAãƒœã‚¿ãƒ³ã®`<a>`ã‚¿ã‚° | æ—¢å­˜ãŒã‚ã‚Œã°æŒ¿å…¥ã—ãªã„ |
| ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | `</body>` ç›´å‰ | æ—¢å­˜ãŒã‚ã‚Œã°æŒ¿å…¥ã—ãªã„ |

**é‡è¤‡ãƒã‚§ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯:**
1. GTMã‚¿ã‚°: `googletagmanager.com` ã¾ãŸã¯ `GTM-` ã‚’å«ã‚€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ¤œå‡º
2. LINEå‹ã ã¡ç™»éŒ²å±æ€§: `data-cats="lineFriendsFollowLink"` å±æ€§ã‚’æ¤œå‡º
3. ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°: `tracking.js` ã¾ãŸã¯ `/api/lp-tracking` ã‚’å«ã‚€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ¤œå‡º

### 2.4.1 LINEå‹ã ã¡ç™»éŒ²ãƒœã‚¿ãƒ³å±æ€§ã®è‡ªå‹•æŒ¿å…¥

LINEå‹ã ã¡ç™»éŒ²ãƒœã‚¿ãƒ³ï¼ˆCTAãƒœã‚¿ãƒ³ï¼‰ã«ã¯ã€markecatsé€£æºç”¨ã® `data-cats="lineFriendsFollowLink"` å±æ€§ãŒè‡ªå‹•æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚

**è‡ªå‹•æ¤œå‡ºå¯¾è±¡:**
- `href` ã« `line.me` ã¾ãŸã¯ `lin.ee` ã‚’å«ã‚€ãƒªãƒ³ã‚¯
- ã‚¯ãƒ©ã‚¹åã« `btn-line`, `line-btn`, `line-cta`, `line-friend` ã‚’å«ã‚€è¦ç´ 

**æŒ¿å…¥ä¾‹:**
```html
<!-- æŒ¿å…¥å‰ -->
<a href="#" class="btn-line-cta">å…¬å¼LINEã«ç™»éŒ²</a>

<!-- æŒ¿å…¥å¾Œ -->
<a href="#" class="btn-line-cta" data-cats="lineFriendsFollowLink">å…¬å¼LINEã«ç™»éŒ²</a>
```

> **Note:** LINE Tagè‡ªä½“ã¯GTMçµŒç”±ã§è¨­ç½®ã•ã‚Œã‚‹ãŸã‚ã€HTMLå†…ã«ã¯è‡ªå‹•æŒ¿å…¥ã•ã‚Œã¾ã›ã‚“ã€‚
> `has_line_tag` ãƒ•ãƒ©ã‚°ã¯ `data-cats` å±æ€§ã®æœ‰ç„¡ã§åˆ¤å®šã•ã‚Œã¾ã™ã€‚

### 2.5 ç”»åƒãƒ‘ã‚¹å¤‰æ›

ZIPã«å«ã¾ã‚Œã‚‹ç”»åƒã¯ Supabase Storage ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€HTMLå†…ã®ç›¸å¯¾ãƒ‘ã‚¹ã¯è‡ªå‹•ã§çµ¶å¯¾URLã«å¤‰æ›ã•ã‚Œã‚‹ã€‚

```html
<!-- å¤‰æ›å‰ -->
<img src="images/hero.png">
<img src="./images/logo.svg">

<!-- å¤‰æ›å¾Œ -->
<img src="https://xxx.supabase.co/storage/v1/object/public/lp-assets/0/images/hero.png">
<img src="https://xxx.supabase.co/storage/v1/object/public/lp-assets/0/images/logo.svg">
```

### 2.6 ç®¡ç†ç”»é¢æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| LPè¿½åŠ  | ZIPã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ è‡ªå‹•ã‚¿ã‚°æŒ¿å…¥ â†’ Supabaseä¿å­˜ |
| LPç·¨é›† | åŒã˜LPç•ªå·ã«å†ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ä¸Šæ›¸ãæ›´æ–° |
| LPå‰Šé™¤ | ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¾Œã«å‰Šé™¤ï¼ˆStorage + DBï¼‰ |
| è­¦å‘Šè¡¨ç¤º | GTM/LINE/ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°æœªè¨­å®šã®LPã«è­¦å‘Šã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º |

### 2.7 è­¦å‘Šã‚¢ã‚¤ã‚³ãƒ³

ç®¡ç†ç”»é¢ã®LPä¸€è¦§ã§ã€ä»¥ä¸‹ã®çŠ¶æ…‹ã‚’è­¦å‘Šè¡¨ç¤ºã™ã‚‹ï¼š

| çŠ¶æ…‹ | è¡¨ç¤º |
|------|------|
| GTMã‚¿ã‚°ãªã— | âš ï¸ GTMæœªè¨­å®š |
| LINEã‚¿ã‚°ãªã— | âš ï¸ LINEæœªè¨­å®š |
| ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ãªã— | âš ï¸ ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°æœªè¨­å®š |
| å…¨ã¦è¨­å®šæ¸ˆã¿ | âœ“ |

### 2.8 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

```prisma
model LandingPage {
  id            Int      @id @default(autoincrement())
  lp_number     Int      @unique  // 0, 1, 2...
  name          String   // LPå
  has_gtm       Boolean  @default(false)
  has_line_tag  Boolean  @default(false)
  has_tracking  Boolean  @default(false)
  is_published  Boolean  @default(true)   // å…¬é–‹çŠ¶æ…‹
  storage_path  String   // Supabase Storageå†…ã®ãƒ‘ã‚¹
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt

  @@map("landing_pages")
}
```

> **Note:** ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯ã™ã¹ã¦snake_caseã§çµ±ä¸€ã€‚`is_published`ã¯LPã®å…¬é–‹/éå…¬é–‹ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ•ãƒ©ã‚°ã€‚

### 2.9 API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**POST `/api/lp/upload`** - LPã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
```typescript
// Request: multipart/form-data
{
  file: File,        // ZIPãƒ•ã‚¡ã‚¤ãƒ«
  name: string,      // LPå
  lpNumber?: number  // æŒ‡å®šæ™‚ã¯ä¸Šæ›¸ãã€æœªæŒ‡å®šã¯æ–°è¦æ¡ç•ª
}

// Response
{
  success: true,
  lpNumber: 3,
  url: '/lp/3'
}
```

**DELETE `/api/lp/[id]`** - LPå‰Šé™¤
```typescript
// Response
{ success: true }
```

**GET `/api/lp/[id]`** - LPé…ä¿¡ï¼ˆèªè¨¼ä¸è¦ï¼‰
```typescript
// å…¬é–‹ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆmiddlewareã§é™¤å¤–æ¸ˆã¿ï¼‰
// Response: HTML content (Content-Type: text/html)
// index.htmlé…ä¿¡æ™‚ã€DBã‹ã‚‰LINEã‚¿ã‚°ã‚’å–å¾—ã—<head>å†…ã«scriptã¨ã—ã¦å‹•çš„æ³¨å…¥
```

**GET `/api/lp-line-tags`** - LINEã‚¿ã‚°ä¸€è¦§å–å¾—
```typescript
// Response
{ tags: [{ id, key, label, url, sort_order, is_default }] }
// ã‚¿ã‚°ãŒç©ºã®å ´åˆã€google/metaã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ã—ã¦è‡ªå‹•ã‚·ãƒ¼ãƒ‰
```

**POST `/api/lp-line-tags`** - LINEã‚¿ã‚°æ“ä½œï¼ˆcreate / update / deleteï¼‰
```typescript
// create: { action: 'create', key, label, url }
// update: { action: 'update', id, key?, label?, url?, is_default? }
// delete: { action: 'delete', id }
```

### 2.10 LINEã‚¿ã‚°ç®¡ç†

LINEã‚¿ã‚°ï¼ˆåºƒå‘Šãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥LINEå‹ã ã¡è¿½åŠ URLï¼‰ã¯DBç®¡ç†ã•ã‚Œã‚‹ã€‚

**ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆ`lp_line_tags`ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰:**
| ã‚«ãƒ©ãƒ  | å‹ | èª¬æ˜ |
|--------|-----|------|
| key | VARCHAR(50) UNIQUE | utm_sourceã®å€¤ï¼ˆä¾‹: `google`, `meta`ï¼‰ |
| label | TEXT | è¡¨ç¤ºåï¼ˆä¾‹: `Googleåºƒå‘Š`, `Metaåºƒå‘Š`ï¼‰ |
| url | TEXT | LINEå‹ã ã¡è¿½åŠ URL |
| sort_order | INT | è¡¨ç¤ºé † |
| is_default | BOOLEAN | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ã‚°ãƒ•ãƒ©ã‚° |

**å‹•çš„æ³¨å…¥ã®ä»•çµ„ã¿:**
1. LPé…ä¿¡APIï¼ˆ`GET /api/lp/[id]`ï¼‰ãŒindex.htmlã‚’è¿”ã™éš›ã€DBã‹ã‚‰LINEã‚¿ã‚°ã‚’å…¨ä»¶å–å¾—
2. `</head>`ã®å‰ã«ä»¥ä¸‹ã®scriptã‚¿ã‚°ã‚’æ³¨å…¥:
   ```html
   <script>
   window.__LP_LINE_TAGS={"google":"https://...","meta":"https://..."};
   window.__LP_LINE_TAG_DEFAULT="google";
   </script>
   ```
3. tracking.jsãŒ`window.__LP_LINE_TAGS`ã‹ã‚‰utm_sourceã«å¯¾å¿œã™ã‚‹URLã‚’å–å¾—ã—ã¦LINEãƒœã‚¿ãƒ³ã«è¨­å®š

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆè‡ªå‹•ã‚·ãƒ¼ãƒ‰ï¼‰:**
| key | label | URL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|-----|-------|-----|-----------|
| `google` | Googleåºƒå‘Š | `https://liff.line.me/2009053059-UzfNXDJd/landing?follow=%40894ipobi&lp=4Ghdqp&liff_id=2009053059-UzfNXDJd` | âœ… |
| `meta` | Metaåºƒå‘Š | `https://liff.line.me/2009053059-UzfNXDJd/landing?follow=%40894ipobi&lp=GQbsFI&liff_id=2009053059-UzfNXDJd` | |

â€» DBã«ã‚¿ã‚°ãŒå­˜åœ¨ã—ãªã„å ´åˆã€åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«ä¸Šè¨˜2ä»¶ãŒè‡ªå‹•ã‚·ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã€‚

**ç®¡ç†ç”»é¢:**
- LPç®¡ç†ç”»é¢ã®ã€ŒLINEã‚¿ã‚°ç®¡ç†ã€ãƒœã‚¿ãƒ³ã‹ã‚‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã§CRUDæ“ä½œ
- ã‚­ãƒ¼ã¯è‹±å°æ–‡å­—ãƒ»æ•°å­—ãƒ»ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã®ã¿ï¼ˆutm_sourceãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ç”¨ï¼‰
- ã‚¿ã‚°ã®è¿½åŠ ãƒ»ç·¨é›†ã¯å³åº§ã«å…¨LPã«åæ˜ ï¼ˆHTMLé…ä¿¡æ™‚ã«å‹•çš„æ³¨å…¥ã®ãŸã‚ï¼‰

---

## 3. ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰ä½“ç³»

> **Note:** ä»¥é™ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·ï¼ˆ3ã€œ13ï¼‰ã¯å¾“æ¥ã®2ã€œ12ã¨å¯¾å¿œ

### 2.1 å¯¾å¿œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

**ä¸¡æ–¹ã®å½¢å¼ã‚’ã‚µãƒãƒ¼ãƒˆ:**

| å½¢å¼ | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | ä¾‹ |
|------|-----------|-----|
| ç‹¬è‡ªå½¢å¼ | `c` | `/lp/1?c=fb_summer2024` |
| UTMæ¨™æº– | `utm_source`, `utm_medium`, `utm_campaign` | `/lp/1?utm_source=facebook&utm_medium=cpc&utm_campaign=summer2024` |

### 2.2 ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å„ªå…ˆé †ä½
1. ç‹¬è‡ªå½¢å¼ `c` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚Œã°ã€ãã®ã¾ã¾ä½¿ç”¨
2. UTMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚Œã°ã€`{utm_source}_{utm_campaign}` å½¢å¼ã«å¤‰æ›
3. ä¸¡æ–¹ã‚ã‚‹å ´åˆã¯ `c` ã‚’å„ªå…ˆ

### 2.3 UTMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»•æ§˜

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å¿…é ˆ | èª¬æ˜ | ä¾‹ |
|-----------|------|------|-----|
| `utm_source` | â—¯ | æµå…¥å…ƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | `facebook`, `google`, `instagram`, `line` |
| `utm_medium` | â—¯ | åºƒå‘Šãƒ¡ãƒ‡ã‚£ã‚¢ã‚¿ã‚¤ãƒ— | `cpc`, `display`, `social`, `email` |
| `utm_campaign` | â—¯ | ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å | `summer2024`, `nurse_recruit` |
| `utm_term` | â–³ | æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆæ¤œç´¢åºƒå‘Šç”¨ï¼‰ | `çœ‹è­·å¸« æ±‚äºº` |
| `utm_content` | â–³ | åºƒå‘Šãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³è­˜åˆ¥ | `banner_a`, `video_01` |

### 2.4 ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰å‘½åè¦å‰‡ï¼ˆæ¨å¥¨ï¼‰

```
{ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ }_{ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å}_{æ—¥ä»˜}_{ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³}
```

ä¾‹:
- `fb_nurse_202401_a` - Facebookã€çœ‹è­·å¸«å‘ã‘ã€2024å¹´1æœˆã€ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³A
- `ig_caregiver_202402_video` - Instagramã€ä»‹è­·å£«å‘ã‘ã€2024å¹´2æœˆã€å‹•ç”»åºƒå‘Š

### 2.5 ã‚³ãƒ¼ãƒ‰ã‚¸ãƒ£ãƒ³ãƒ«ç®¡ç†

#### 2.5.1 æ¦‚è¦
ã‚³ãƒ¼ãƒ‰ç™ºè¡Œæ™‚ã«ã‚¸ãƒ£ãƒ³ãƒ«ï¼ˆç”¨é€”ï¼‰ã‚’é¸æŠã—ã€ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ä»˜ãã®ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€åˆ†ææ™‚ã«ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»ã‚½ãƒ¼ãƒˆãŒå¯èƒ½ã«ãªã‚‹ã€‚

#### 2.5.2 ã‚³ãƒ¼ãƒ‰ä½“ç³»

```
{ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹}-{ãƒ©ãƒ³ãƒ€ãƒ è‹±æ•°å­—6æ–‡å­—}
```

ä¾‹:
- `LIN-A1B2C3` - LINEç”¨ã®ã‚³ãƒ¼ãƒ‰
- `MET-X4Y5Z6` - Metaåºƒå‘Šç”¨ã®ã‚³ãƒ¼ãƒ‰

#### 2.5.3 ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¸ãƒ£ãƒ³ãƒ«

| ã‚¸ãƒ£ãƒ³ãƒ«å | ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ | èª¬æ˜ |
|-----------|---------------|------|
| LINE | `LIN` | LINEåºƒå‘Šãƒ»LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç”¨ |
| Metaåºƒå‘Š | `MET` | Metaåºƒå‘Šãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å…¨èˆ¬ |
| Facebook | `FAC` | Facebookå˜ä½“åºƒå‘Šç”¨ |
| Instagram | `INS` | Instagramå˜ä½“åºƒå‘Šç”¨ |
| Messenger | `MSG` | Messengeråºƒå‘Šç”¨ |
| Audience Network | `AUD` | Audience Networkç”¨ |
| Threads | `THR` | Threadsåºƒå‘Šç”¨ |

#### 2.5.4 ã‚¸ãƒ£ãƒ³ãƒ«ç®¡ç†æ©Ÿèƒ½

- **ã‚¸ãƒ£ãƒ³ãƒ«è¿½åŠ **: æ–°ã—ã„ã‚¸ãƒ£ãƒ³ãƒ«ï¼ˆåå‰ãƒ»ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼‰ã‚’è¿½åŠ å¯èƒ½
- **ã‚¸ãƒ£ãƒ³ãƒ«ç·¨é›†**: æ—¢å­˜ã‚¸ãƒ£ãƒ³ãƒ«ã®åå‰ã‚’ç·¨é›†å¯èƒ½ï¼ˆãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¯å¤‰æ›´ä¸å¯ï¼‰
- **ã‚¸ãƒ£ãƒ³ãƒ«å‰Šé™¤**: æœªä½¿ç”¨ã®ã‚¸ãƒ£ãƒ³ãƒ«ã‚’å‰Šé™¤å¯èƒ½
- **æ¨©é™**: LPç®¡ç†ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯èª°ã§ã‚‚ç·¨é›†å¯èƒ½

#### 2.5.5 ã‚³ãƒ¼ãƒ‰ç™ºè¡Œãƒ•ãƒ­ãƒ¼

1. ã€Œã‚³ãƒ¼ãƒ‰ç™ºè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠãƒ¢ãƒ¼ãƒ€ãƒ«ãŒè¡¨ç¤º
   - ã‚¸ãƒ£ãƒ³ãƒ«ä¸€è¦§ï¼ˆãƒªã‚¹ãƒˆå½¢å¼ï¼‰
   - ã€Œã‚¸ãƒ£ãƒ³ãƒ«ç·¨é›†ã€ãƒœã‚¿ãƒ³
3. ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸æŠ
4. è‡ªå‹•ã§ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ä»˜ãã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã‚‹

#### 2.5.6 åˆ†ææ™‚ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

- ã‚³ãƒ¼ãƒ‰ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‹ã‚‰ã‚¸ãƒ£ãƒ³ãƒ«ã‚’åˆ¤å®š
- ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ã§ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ãŒå¯èƒ½
- ä¾‹: ã€ŒLINEç³»ã®å…¨ã‚³ãƒ¼ãƒ‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ã€ŒMetaåºƒå‘Šç³»ã®æ¯”è¼ƒã€ãªã©

---

## 3. ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚¤ãƒ™ãƒ³ãƒˆ

### 3.1 è‡ªå‹•è¨ˆæ¸¬ã‚¤ãƒ™ãƒ³ãƒˆ

| ã‚¤ãƒ™ãƒ³ãƒˆ | ãƒˆãƒªã‚¬ãƒ¼ | è¨˜éŒ²ãƒ‡ãƒ¼ã‚¿ |
|---------|---------|-----------|
| `pageview` | ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ | LP ID, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰, ã‚»ãƒƒã‚·ãƒ§ãƒ³ID, UA, ãƒªãƒ•ã‚¡ãƒ©ãƒ¼, IP |
| `scroll_25` | 25%ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ°é” | LP ID, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰, ã‚»ãƒƒã‚·ãƒ§ãƒ³ID, åˆ°é”æ™‚é–“ |
| `scroll_50` | 50%ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ°é” | åŒä¸Š |
| `scroll_75` | 75%ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ°é” | åŒä¸Š |
| `scroll_90` | 90%ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ°é” | åŒä¸Š |
| `dwell_5s` | 5ç§’æ»åœ¨ | LP ID, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰, ã‚»ãƒƒã‚·ãƒ§ãƒ³ID |
| `dwell_10s` | 10ç§’æ»åœ¨ | åŒä¸Š |
| `cta_click` | LINEç™»éŒ²ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ | LP ID, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰, ã‚»ãƒƒã‚·ãƒ§ãƒ³ID, ãƒœã‚¿ãƒ³ID, ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ |

### 3.2 CTAã‚¯ãƒªãƒƒã‚¯ã®å®šç¾©
- **CTAã‚¯ãƒªãƒƒã‚¯ = LINEç™»éŒ²ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯**
- å¯¾è±¡ã‚»ãƒ¬ã‚¯ã‚¿:
  - `.btn-line-cta`
  - `.btn-line-header`
  - ãƒ†ã‚­ã‚¹ãƒˆã«ã€ŒLINEã€ã‚’å«ã‚€ãƒªãƒ³ã‚¯/ãƒœã‚¿ãƒ³

### 3.3 ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³

ä»¥ä¸‹ã®5æ®µéšã§ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã‚’åˆ†é¡:

| ãƒ¬ãƒ™ãƒ« | æ¡ä»¶ | æ„å‘³ |
|-------|------|------|
| Level 1 | 5ç§’ä»¥ä¸Šæ»åœ¨ | èˆˆå‘³ã‚ã‚Š |
| Level 2 | 10ç§’ä»¥ä¸Šæ»åœ¨ | é–¢å¿ƒã‚ã‚Š |
| Level 3 | 10ç§’ä»¥ä¸Šæ»åœ¨ ã‹ã¤ 50%ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« | æ¤œè¨ä¸­ |
| Level 4 | 10ç§’ä»¥ä¸Šæ»åœ¨ ã‹ã¤ 75%ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« | é«˜é–¢å¿ƒ |
| Level 5 | 10ç§’ä»¥ä¸Šæ»åœ¨ ã‹ã¤ 90%ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« | éå¸¸ã«é«˜ã„é–¢å¿ƒ |

---

## 4. ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

### 4.1 localStorageä»•æ§˜

| ã‚­ãƒ¼ | å€¤ | ä¿æŒæœŸé–“ | ç”¨é€” |
|-----|-----|---------|------|
| `lp_campaign_code` | ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰ | 7æ—¥é–“ | ãƒ¯ãƒ¼ã‚«ãƒ¼ç™»éŒ²æ™‚ã®ã‚¢ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ |
| `lp_first_visit` | ISOæ—¥æ™‚ | 7æ—¥é–“ | åˆå›è¨ªå•æ—¥æ™‚ |
| `lp_id` | LPè­˜åˆ¥å­ | 7æ—¥é–“ | æµå…¥LPç‰¹å®š |
| `lp_utm_source` | utm_sourceå€¤ | 7æ—¥é–“ | æµå…¥å…ƒè¿½è·¡ |
| `lp_utm_medium` | utm_mediumå€¤ | 7æ—¥é–“ | ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¿ã‚¤ãƒ—è¿½è·¡ |
| `lp_utm_campaign` | utm_campaignå€¤ | 7æ—¥é–“ | ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¿½è·¡ |

### 4.2 sessionStorageä»•æ§˜

| ã‚­ãƒ¼ | å€¤ | ç”¨é€” |
|-----|-----|------|
| `lp_session_id` | `sess_{random}_{timestamp}` | ã‚»ãƒƒã‚·ãƒ§ãƒ³è­˜åˆ¥ |

### 4.3 ãƒ¯ãƒ¼ã‚«ãƒ¼ç™»éŒ²æ™‚ã®ã‚¢ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²ã™ã‚‹éš›ã€localStorageã®å€¤ã‚’èª­ã¿å–ã‚Šã€Workerãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜:

```typescript
// Workerç™»éŒ²æ™‚ã«ä¿å­˜ã™ã‚‹å€¤
{
  lp_campaign_code: localStorage.getItem('lp_campaign_code'),
  lp_id: localStorage.getItem('lp_id'),
  lp_utm_source: localStorage.getItem('lp_utm_source'),
  lp_first_visit: localStorage.getItem('lp_first_visit')
}
```

---

## 5. GTM / dataLayer é€£æº

### 5.1 dataLayer.push() ã‚¤ãƒ™ãƒ³ãƒˆ

ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã€ä»¥ä¸‹ã®å½¢å¼ã§dataLayerã«push:

```javascript
// ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼
dataLayer.push({
  event: 'lp_pageview',
  lp_id: '1',
  campaign_code: 'fb_summer2024',
  utm_source: 'facebook',
  utm_medium: 'cpc',
  utm_campaign: 'summer2024'
});

// ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
dataLayer.push({
  event: 'lp_scroll',
  scroll_depth: 50,  // 25, 50, 75, 90
  lp_id: '1',
  campaign_code: 'fb_summer2024'
});

// æ»åœ¨æ™‚é–“
dataLayer.push({
  event: 'lp_dwell',
  dwell_seconds: 10,  // 5, 10
  lp_id: '1',
  campaign_code: 'fb_summer2024'
});

// CTAã‚¯ãƒªãƒƒã‚¯
dataLayer.push({
  event: 'lp_cta_click',
  button_id: 'line_register_main',
  button_text: 'LINEã§ç™»éŒ²ã™ã‚‹',
  lp_id: '1',
  campaign_code: 'fb_summer2024'
});

// ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³é”æˆ
dataLayer.push({
  event: 'lp_engagement',
  engagement_level: 3,  // 1-5
  engagement_pattern: '10ç§’ä»¥ä¸Šæ»åœ¨ã‹ã¤50%åˆ°é”',
  lp_id: '1',
  campaign_code: 'fb_summer2024'
});
```

### 5.2 GTMè¨­å®šã‚¬ã‚¤ãƒ‰

åˆ¥é€”ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‚ç…§: `docs/gtm-implementation-guide.md`

---

## 6. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºé …ç›®

### 6.1 æ¦‚è¦æŒ‡æ¨™

| æŒ‡æ¨™ | å®šç¾© | ç®—å‡ºæ–¹æ³• |
|------|------|---------|
| PVï¼ˆãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ï¼‰ | ãƒšãƒ¼ã‚¸è¡¨ç¤ºå›æ•° | `pageview`ã‚¤ãƒ™ãƒ³ãƒˆæ•° |
| UUï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ | ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•° | `session_id`ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯æ•° |
| CTAã‚¯ãƒªãƒƒã‚¯æ•° | LINEç™»éŒ²ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ•° | `cta_click`ã‚¤ãƒ™ãƒ³ãƒˆæ•° |
| CTRï¼ˆã‚¯ãƒªãƒƒã‚¯ç‡ï¼‰ | CTAã‚¯ãƒªãƒƒã‚¯ç‡ | CTAã‚¯ãƒªãƒƒã‚¯æ•° / UU Ã— 100 |
| å¹³å‡æ»åœ¨æ™‚é–“ | å¹³å‡ãƒšãƒ¼ã‚¸æ»åœ¨æ™‚é–“ | å…¨æ»åœ¨æ™‚é–“ / ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•° |
| å¹³å‡ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ·±åº¦ | å¹³å‡åˆ°é”ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½® | æœ€å¤§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã®å¹³å‡ |

### 6.2 ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆåˆ†æ

ã™ã¹ã¦ã®æŒ‡æ¨™ã‚’ **ã€Œå…¨ä½“ / CTAã‚¯ãƒªãƒƒã‚¯ã‚ã‚Š / CTAã‚¯ãƒªãƒƒã‚¯ãªã—ã€ã®3åˆ—æ¯”è¼ƒ** ã§è¡¨ç¤ºã€‚

#### è¡¨ç¤ºåˆ‡æ›¿ãƒ¢ãƒ¼ãƒ‰

| ãƒ¢ãƒ¼ãƒ‰ | èª¬æ˜ |
|-------|------|
| å…¨ä½“ | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŒ‡æ¨™ã®ã¿è¡¨ç¤º |
| CTAã‚¯ãƒªãƒƒã‚¯ã‚ã‚Š | CTAã‚¯ãƒªãƒƒã‚¯ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ |
| CTAã‚¯ãƒªãƒƒã‚¯ãªã— | CTAã‚¯ãƒªãƒƒã‚¯ã—ãªã‹ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ |
| **æ¯”è¼ƒ**ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ | 3åˆ—ä¸¦ã¹ã¦æ¯”è¼ƒè¡¨ç¤º |

#### è¡¨ç¤ºé …ç›®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆåˆ†æ                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è¡¨ç¤ºåˆ‡æ›¿: [å…¨ä½“] [CTAã‚¯ãƒªãƒƒã‚¯ã‚ã‚Š] [CTAã‚¯ãƒªãƒƒã‚¯ãªã—] [æ¯”è¼ƒ]   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ°é”ç‡                                                 â”‚
â”‚                      å…¨ä½“      CTAã‚ã‚Š    CTAãªã—               â”‚
â”‚  25%åˆ°é”            85%        98%        78%                  â”‚
â”‚  50%åˆ°é”            68%        95%        52%                  â”‚
â”‚  75%åˆ°é”            42%        88%        25%                  â”‚
â”‚  90%åˆ°é”            25%        72%        12%                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ»åœ¨æ™‚é–“é”æˆç‡                                                   â”‚
â”‚                      å…¨ä½“      CTAã‚ã‚Š    CTAãªã—               â”‚
â”‚  5ç§’ä»¥ä¸Š            80%        99%        72%                  â”‚
â”‚  10ç§’ä»¥ä¸Š           60%        96%        45%                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«åˆ†å¸ƒ                                        â”‚
â”‚                      å…¨ä½“      CTAã‚ã‚Š    CTAãªã—               â”‚
â”‚  Level 1 (5ç§’)      320äºº      78äºº       242äºº                â”‚
â”‚  Level 2 (10ç§’)     240äºº      75äºº       165äºº                â”‚
â”‚  Level 3 (10ç§’+50%) 160äºº      72äºº       88äºº                 â”‚
â”‚  Level 4 (10ç§’+75%) 80äºº       65äºº       15äºº                 â”‚
â”‚  Level 5 (10ç§’+90%) 40äºº       35äºº       5äºº                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¹³å‡å€¤ã‚µãƒãƒªãƒ¼                                                   â”‚
â”‚                      å…¨ä½“      CTAã‚ã‚Š    CTAãªã—               â”‚
â”‚  å¹³å‡æ»åœ¨æ™‚é–“        18ç§’      45ç§’       12ç§’                  â”‚
â”‚  å¹³å‡ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ·±åº¦  48%       78%        35%                   â”‚
â”‚  å¹³å‡ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸Lv    2.4       4.2        1.8                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥æ»åœ¨æ™‚é–“ï¼ˆãƒ’ãƒ¼ãƒˆã‚¹ãƒãƒƒãƒˆï¼‰                            â”‚
â”‚                      å…¨ä½“      CTAã‚ã‚Š    CTAãªã—               â”‚
â”‚  Hero               28ç§’      35ç§’       24ç§’                  â”‚
â”‚  ç‰¹å¾´ç´¹ä»‹           18ç§’      28ç§’       14ç§’                  â”‚
â”‚  åˆ©ç”¨è€…ã®å£°         12ç§’      22ç§’       8ç§’                   â”‚
â”‚  æ–™é‡‘ãƒ—ãƒ©ãƒ³         22ç§’      38ç§’       16ç§’                  â”‚
â”‚  CTA                6ç§’       15ç§’       3ç§’                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š Clarityã§è©³ç´°ãªãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã‚’è¦‹ã‚‹ â†’ï¼ˆåˆ¥ã‚¿ãƒ–ã§é–‹ãï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å¤–éƒ¨ãƒ„ãƒ¼ãƒ«é€£æº

| ãƒ„ãƒ¼ãƒ« | å½¹å‰² | é–²è¦§å ´æ‰€ |
|-------|------|---------|
| è‡ªå‰å®Ÿè£… | ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒ»æ»åœ¨æ™‚é–“ãƒ»ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆåˆ†æ | `/lp/tracking` å†… |
| Microsoft Clarity | ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³éŒ²ç”» | åˆ¥ã‚¿ãƒ–ï¼ˆclarity.microsoft.comï¼‰ |

### 6.3 ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶

- LP IDï¼ˆ1, 2, 3...ï¼‰
- ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚³ãƒ¼ãƒ‰
- æœŸé–“ï¼ˆé–‹å§‹æ—¥ã€œçµ‚äº†æ—¥ï¼‰
- UTMã‚½ãƒ¼ã‚¹
- ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«

### 6.4 ãƒ’ãƒ¼ãƒˆã‚¹ãƒãƒƒãƒˆè¡¨ç¤º

ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã”ã¨ã®æ»åœ¨æ™‚é–“ã‚’å¯è¦–åŒ–:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hero Section          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 45s â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Features Section      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 32s   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Testimonials          â–ˆâ–ˆâ–ˆâ–ˆ 18s     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CTA Section           â–ˆâ–ˆâ–ˆ 12s      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

### 7.1 æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«

```prisma
model LpPageView {
  id            String   @id @default(cuid())
  lp_id         String
  campaign_code String?
  session_id    String
  user_agent    String?
  referrer      String?
  ip_address    String?
  created_at    DateTime @default(now())

  @@index([lp_id])
  @@index([campaign_code])
  @@index([created_at])
  @@map("lp_page_views")
}

model LpClickEvent {
  id            String   @id @default(cuid())
  lp_id         String
  campaign_code String?
  session_id    String
  button_id     String
  button_text   String?
  created_at    DateTime @default(now())

  @@index([lp_id])
  @@index([campaign_code])
  @@index([created_at])
  @@map("lp_click_events")
}
```

### 7.2 è¿½åŠ ãƒ†ãƒ¼ãƒ–ãƒ«

```prisma
// ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ
model LpScrollEvent {
  id            String   @id @default(cuid())
  lp_id         String
  campaign_code String?
  session_id    String
  scroll_depth  Int      // 25, 50, 75, 90
  time_to_reach Int?     // åˆ°é”ã¾ã§ã®ç§’æ•°
  created_at    DateTime @default(now())

  @@index([lp_id])
  @@index([campaign_code])
  @@index([session_id])
  @@map("lp_scroll_events")
}

// æ»åœ¨æ™‚é–“ã‚¤ãƒ™ãƒ³ãƒˆ
model LpDwellEvent {
  id            String   @id @default(cuid())
  lp_id         String
  campaign_code String?
  session_id    String
  dwell_seconds Int      // 5, 10
  created_at    DateTime @default(now())

  @@index([lp_id])
  @@index([campaign_code])
  @@index([session_id])
  @@map("lp_dwell_events")
}

// ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥æ»åœ¨æ™‚é–“ï¼ˆãƒ’ãƒ¼ãƒˆã‚¹ãƒãƒƒãƒˆç”¨ï¼‰
model LpSectionDwell {
  id            String   @id @default(cuid())
  lp_id         String
  campaign_code String?
  session_id    String
  section_id    String   // ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è­˜åˆ¥å­
  section_name  String?  // ã‚»ã‚¯ã‚·ãƒ§ãƒ³å
  dwell_seconds Float    // æ»åœ¨ç§’æ•°
  created_at    DateTime @default(now())

  @@index([lp_id])
  @@index([session_id])
  @@map("lp_section_dwells")
}

// ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚µãƒãƒªãƒ¼ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«é›†è¨ˆï¼‰
model LpEngagementSummary {
  id                String   @id @default(cuid())
  lp_id             String
  campaign_code     String?
  session_id        String   @unique
  max_scroll_depth  Int      // æœ€å¤§åˆ°é”ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ·±åº¦
  total_dwell_time  Int      // ç·æ»åœ¨æ™‚é–“ï¼ˆç§’ï¼‰
  engagement_level  Int      // 1-5
  cta_clicked       Boolean  // CTAã‚¯ãƒªãƒƒã‚¯ã—ãŸã‹
  utm_source        String?
  utm_medium        String?
  utm_campaign      String?
  created_at        DateTime @default(now())

  @@index([lp_id])
  @@index([campaign_code])
  @@index([engagement_level])
  @@index([cta_clicked])
  @@map("lp_engagement_summaries")
}
```

### 7.3 Workerãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ

```prisma
model Worker {
  // ... æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

  // LP ã‚¢ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³
  lp_campaign_code  String?
  lp_id             String?
  lp_utm_source     String?
  lp_first_visit    DateTime?
}
```

---

## 8. API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### 8.1 ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°API

**POST `/api/lp-tracking`**

```typescript
// Request Body
{
  type: 'pageview' | 'scroll' | 'dwell' | 'click' | 'section_dwell' | 'engagement_summary',
  lpId: string,
  campaignCode?: string,
  sessionId: string,

  // typeåˆ¥ã®è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  scrollDepth?: number,      // scrollç”¨
  timeToReach?: number,      // scrollç”¨
  dwellSeconds?: number,     // dwellç”¨
  buttonId?: string,         // clickç”¨
  buttonText?: string,       // clickç”¨
  sectionId?: string,        // section_dwellç”¨
  sectionName?: string,      // section_dwellç”¨

  // engagement_summaryç”¨
  maxScrollDepth?: number,
  totalDwellTime?: number,
  engagementLevel?: number,
  ctaClicked?: boolean,
  utmSource?: string,
  utmMedium?: string,
  utmCampaign?: string
}

// Response
{ success: true }
```

### 8.2 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰API

**GET `/api/lp-tracking`**

```typescript
// Query Parameters
{
  lpId?: string,
  campaignCode?: string,
  startDate?: string,    // YYYY-MM-DD
  endDate?: string,      // YYYY-MM-DD
  utmSource?: string,
  engagementLevel?: number
}

// Response
{
  summary: {
    totalPageViews: number,
    uniqueSessions: number,
    ctaClicks: number,
    ctr: number,
    avgDwellTime: number,
    avgScrollDepth: number
  },
  engagementDistribution: {
    level1: { count: number, percentage: number },
    level2: { count: number, percentage: number },
    level3: { count: number, percentage: number },
    level4: { count: number, percentage: number },
    level5: { count: number, percentage: number }
  },
  ctaComparison: {
    clicked: {
      avgEngagementLevel: number,
      avgDwellTime: number,
      avgScrollDepth: number
    },
    notClicked: {
      avgEngagementLevel: number,
      avgDwellTime: number,
      avgScrollDepth: number
    }
  },
  sectionHeatspot: [
    { sectionId: string, sectionName: string, avgDwellTime: number }
  ],
  dailyTrend: [
    { date: string, pageViews: number, uniqueSessions: number, ctaClicks: number }
  ]
}
```

---

## 9. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰å®Ÿè£…

### 9.1 tracking.js æ¦‚è¦

```javascript
(function() {
  // è¨­å®š
  const CONFIG = {
    SCROLL_THRESHOLDS: [25, 50, 75, 90],
    DWELL_THRESHOLDS: [5, 10],
    STORAGE_EXPIRY_DAYS: 7,
    API_ENDPOINT: '/api/lp-tracking'
  };

  // åˆæœŸåŒ–
  function init() {
    const params = parseUrlParams();
    storeToLocalStorage(params);
    initSession();
    trackPageView();
    initScrollTracking();
    initDwellTracking();
    initClickTracking();
    initSectionTracking();
    initPageUnloadHandler();
  }

  // URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è§£æï¼ˆcå„ªå…ˆã€UTMãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
  function parseUrlParams() { ... }

  // localStorage ä¿å­˜ï¼ˆ7æ—¥é–“æœ‰åŠ¹ï¼‰
  function storeToLocalStorage(params) { ... }

  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
  function initScrollTracking() { ... }

  // æ»åœ¨æ™‚é–“ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
  function initDwellTracking() { ... }

  // CTAã‚¯ãƒªãƒƒã‚¯ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
  function initClickTracking() { ... }

  // ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥æ»åœ¨æ™‚é–“
  function initSectionTracking() { ... }

  // ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ã®ã‚µãƒãƒªãƒ¼é€ä¿¡
  function initPageUnloadHandler() { ... }

  // dataLayer.push()
  function pushToDataLayer(eventName, data) { ... }

  // APIé€ä¿¡ï¼ˆBeacon APIä½¿ç”¨ï¼‰
  function sendToAPI(data) { ... }

  // åˆæœŸåŒ–å®Ÿè¡Œ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
```

---

## 10. å¤–éƒ¨ãƒ„ãƒ¼ãƒ«é€£æº

### 10.1 Microsoft Clarityï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

è©³ç´°ãªãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³éŒ²ç”»ãŒå¿…è¦ãªå ´åˆã«å°å…¥ã‚’æ¤œè¨ã€‚

**å°å…¥æ–¹æ³•:**
1. clarity.microsoft.com ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
2. ç™ºè¡Œã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã‚’LPã«åŸ‹ã‚è¾¼ã¿
3. Clarityãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆåˆ¥ã‚µã‚¤ãƒˆï¼‰ã§ç¢ºèª

**æ³¨æ„:** Clarityã¯å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã¯Microsoftã®ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹ã€‚

### 10.2 GA4é€£æº

dataLayerã‚’é€šã˜ã¦GA4ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡ã€‚
GTMå´ã§dataLayerã‚¤ãƒ™ãƒ³ãƒˆã‚’GA4ã‚¤ãƒ™ãƒ³ãƒˆã«å¤‰æ›ã™ã‚‹è¨­å®šãŒå¿…è¦ã€‚

---

## 11. å®Ÿè£…å„ªå…ˆé †ä½

### Phase 1ï¼ˆé«˜å„ªå…ˆåº¦ï¼‰
1. UTMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¯¾å¿œ
2. ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ï¼ˆ25%, 50%, 75%, 90%ï¼‰
3. æ»åœ¨æ™‚é–“ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ï¼ˆ5ç§’ã€10ç§’ï¼‰
4. ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³è¨ˆç®—
5. localStorageä¿å­˜ï¼ˆ7æ—¥é–“ï¼‰

### Phase 2ï¼ˆä¸­å„ªå…ˆåº¦ï¼‰
1. dataLayer.push() å®Ÿè£…
2. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆè¡¨ç¤º
3. CTAã‚¯ãƒªãƒƒã‚¯æœ‰ç„¡åˆ¥ã®æ¯”è¼ƒè¡¨ç¤º
4. Workerãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®ã‚¢ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ä¿å­˜

### Phase 3ï¼ˆä½å„ªå…ˆåº¦ï¼‰
1. ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥æ»åœ¨æ™‚é–“ï¼ˆãƒ’ãƒ¼ãƒˆã‚¹ãƒãƒƒãƒˆï¼‰
2. GTMå®Ÿè£…ã‚¬ã‚¤ãƒ‰ä½œæˆ
3. LINEé€£æºã‚¬ã‚¤ãƒ‰ä½œæˆ
4. Microsoft Clarityå°å…¥æ¤œè¨

---

## 13. é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `docs/gtm-implementation-guide.md` - GTMãƒãƒ¼ãƒ å‘ã‘å®Ÿè£…ã‚¬ã‚¤ãƒ‰
- `docs/line-parameter-guide.md` - LINEé‹ç”¨ãƒãƒ¼ãƒ å‘ã‘ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šã‚¬ã‚¤ãƒ‰
- `docs/system-design.md` - ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸ï¼ˆæŒ‡æ¨™å®šç¾©ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‚ç…§ï¼‰
- `/system-admin/lp/guide` - LPä½œæˆã‚¬ã‚¤ãƒ‰ï¼ˆç®¡ç†ç”»é¢å†…ï¼‰
